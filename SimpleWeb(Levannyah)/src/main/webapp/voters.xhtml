<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

  <h:head>
    <title>Simple App | Voters</title>
    <ui:include src="/inc/header.xhtml"/>

    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css"/>

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>

    <style>
      .custom-container {
        padding-left: 100px;
        padding-right: 100px;
      }
      </style>
  </h:head>

  <h:body styleClass="cyan lighten-5">
    <ui:include src="/inc/navbar-admin.xhtml"/>

    <section id="users" class="section section-users" style="text-align: center;">
      <div class="custom-container">
        <h4 style="margin-top: 2rem; margin-bottom: 1rem;">Voters</h4>
        <h:form>
          <p:growl id="growl" showDetail="true" skipDetailIfEqualsSummary="true">
            <p:autoUpdate/>
          </p:growl>
        </h:form>

        <p:panel style="margin-top: 2rem;">
          <f:facet name="header">
            <h:outputText value="Voter Details" style="font-size: 20px; float: left;"/>
            <p:commandButton icon="pi pi-fw pi-user-plus" styleClass="rounded-button ui-button-info ui-button-flat black-text"
                             style="float: right;" onclick="PF('addVotersDialog').show()" title="Register Voters" />
          </f:facet>

          <table id="votersList" class="highlight responsive-table">
            <thead style="text-align: center;">
            <tr>
              <th style="text-align: center;">No</th>
              <th style="text-align: center;">First Name</th>
              <th style="text-align: center;">Last Name</th>
              <th style="text-align: center;">Username</th>
              <th style="text-align: center;">Email</th>
              <th style="text-align: center;">Status</th>
            </tr>
            </thead>

            <tbody>
            <ui:repeat value="#{voters.voters}" var="voter">
              <tr>
                <td>#{voter.id}</td>
                <td>#{voter.firstName}</td>
                <td>#{voter.lastName}</td>
                <td>#{voter.username}</td>
                <td>#{voter.userEmail}</td>
                <td>#{voter.status}</td>
              </tr>
            </ui:repeat>
            </tbody>
          </table>
        </p:panel>
      </div>
    </section>

    <p:dialog id="addVotersDialog" header="Register Voters" widgetVar="addVotersDialog" modal="true" showEffect="fade" hideEffect="fade" dynamic="true" draggable="false">
      <h:form id="addVotersForm" method="POST">
        <div class="input-field col s12">
          <div class="row">
            <div class="input-field col s6">
              <h:inputText id="firstName" value="#{voters.firstName}" required="true" requiredMessage="First Name is required" autocomplete="off"/>
              <h:outputLabel for="firstName" value="First Name" />
            </div>
            <div class="input-field col s6">
              <h:inputText id="lastName" value="#{voters.lastName}" required="true" requiredMessage="Last Name is required" autocomplete="off"/>
              <h:outputLabel for="lastName" value="Last Name" />
            </div>
          </div>
        </div>

        <div class="row">
          <div class="input-field">
            <h:inputText id="username" value="#{voters.username}" required="true" requiredMessage="Username is required" autocomplete="off"/>
            <h:outputLabel for="username" value="Username" />
          </div>
        </div>

        <div class="row">
          <div class="input-field">
            <h:inputText id="userEmail" value="#{voters.userEmail}" required="true" requiredMessage="Voter's Email is required" autocomplete="off"/>
            <h:outputLabel for="userEmail" value="Voter's Email" />
          </div>
        </div>

        <div class="center-align">
          <p:commandButton value="Cancel" onclick="redirectToVoters()" immediate="true" style="width: 40%;" styleClass="ui-button-danger"/>
          <p:commandButton value="Save" action="#{voters.voterRegistration}" oncomplete="reset()" style="width: 40%;" styleClass="btnTeal"/>
        </div>
      </h:form>
    </p:dialog>

    <div id="myFooter" class="footer" style="background-color: transparent; text-align: center; position: fixed; bottom: 1rem; left: 0; right: 0;">
      <h:outputText escape="false" value="Copyright &#169; 2023 Simple App"/>
    </div>

    <ui:include src="/inc/footer.xhtml"/>

    <script>
        function reset() {
          document.getElementById("addVotersForm").reset();
        }

        $(document).ready(function () {
          $('#votersList').DataTable({
            order: [],
            columnDefs: [{
              targets: "_all",
              orderable: true,
              className: 'center-align'
            }],
            "language": {
              "search": "",
              "searchPlaceholder": "Search",
            },
            "dom": "&lt;'row'&lt;>&lt;'col s12'f>>" +
                   "&lt;'row'&lt;'col s12'tr>>" +
                   "&lt;'row'&lt;'col s12 m5'i>&lt;'col s12 m7'p>>",
          });
        });
      </script>
  </h:body>
</html>